nohup: ignoring input
/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/peft/mapping_func.py:73: UserWarning: You are trying to modify a model with PEFT for a second time. If you want to reload the model with a different config, make sure to call `.unload()` before.
  warnings.warn(
/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/peft/tuners/tuners_utils.py:196: UserWarning: Already found a `peft_config` attribute in the model. This will lead to having multiple adapters in the model. Make sure to know what you are doing!
  warnings.warn(
--- 1. Loading model and tokenizer ---
--- 2. Configuring LoRA (PEFT) ---
Trainable parameters:
trainable params: 2,359,296 || all params: 617,433,088 || trainable%: 0.3821
--- 3. Loading and preprocessing data for language: am ---
Using training file: ./final_data2/am/train_100k.tsv
Using validation file: ./final_data2/am/validation.tsv
--- Applying preprocessing (single-threaded) ---
Map (num_proc=1):   0%|          | 0/100000 [00:00<?, ? examples/s]Map (num_proc=1):   1%|          | 1000/100000 [00:01<02:11, 751.25 examples/s]Map (num_proc=1):   3%|▎         | 3000/100000 [00:01<00:38, 2500.00 examples/s]Map (num_proc=1):   5%|▌         | 5000/100000 [00:01<00:21, 4320.02 examples/s]Map (num_proc=1):   7%|▋         | 7000/100000 [00:01<00:15, 6085.03 examples/s]Map (num_proc=1):   9%|▉         | 9000/100000 [00:01<00:11, 7648.80 examples/s]Map (num_proc=1):  11%|█         | 11000/100000 [00:02<00:15, 5714.79 examples/s]Map (num_proc=1):  13%|█▎        | 13000/100000 [00:02<00:12, 7012.42 examples/s]Map (num_proc=1):  15%|█▌        | 15000/100000 [00:02<00:10, 8272.68 examples/s]Map (num_proc=1):  17%|█▋        | 17000/100000 [00:02<00:08, 9367.53 examples/s]Map (num_proc=1):  19%|█▉        | 19000/100000 [00:03<00:07, 10287.47 examples/s]Map (num_proc=1):  21%|██        | 21000/100000 [00:03<00:07, 11033.50 examples/s]Map (num_proc=1):  23%|██▎       | 23000/100000 [00:03<00:06, 11673.92 examples/s]Map (num_proc=1):  25%|██▌       | 25000/100000 [00:03<00:06, 12114.34 examples/s]Map (num_proc=1):  27%|██▋       | 27000/100000 [00:03<00:05, 12402.96 examples/s]Map (num_proc=1):  29%|██▉       | 29000/100000 [00:03<00:05, 12652.17 examples/s]Map (num_proc=1):  31%|███       | 31000/100000 [00:03<00:05, 12732.74 examples/s]Map (num_proc=1):  33%|███▎      | 33000/100000 [00:04<00:05, 12887.99 examples/s]Map (num_proc=1):  35%|███▌      | 35000/100000 [00:04<00:05, 12934.54 examples/s]Map (num_proc=1):  37%|███▋      | 37000/100000 [00:04<00:04, 13079.92 examples/s]Map (num_proc=1):  39%|███▉      | 39000/100000 [00:04<00:04, 13195.91 examples/s]Map (num_proc=1):  41%|████      | 41000/100000 [00:04<00:04, 13304.71 examples/s]Map (num_proc=1):  43%|████▎     | 43000/100000 [00:04<00:04, 13302.17 examples/s]Map (num_proc=1):  45%|████▌     | 45000/100000 [00:05<00:04, 13213.72 examples/s]Map (num_proc=1):  47%|████▋     | 47000/100000 [00:05<00:04, 13226.69 examples/s]Map (num_proc=1):  49%|████▉     | 49000/100000 [00:05<00:03, 13191.18 examples/s]Map (num_proc=1):  51%|█████     | 51000/100000 [00:05<00:03, 13237.01 examples/s]Map (num_proc=1):  53%|█████▎    | 53000/100000 [00:05<00:04, 10193.07 examples/s]Map (num_proc=1):  55%|█████▌    | 55000/100000 [00:05<00:04, 10930.16 examples/s]Map (num_proc=1):  57%|█████▋    | 57000/100000 [00:06<00:03, 11540.19 examples/s]Map (num_proc=1):  59%|█████▉    | 59000/100000 [00:06<00:03, 11945.64 examples/s]Map (num_proc=1):  61%|██████    | 61000/100000 [00:06<00:03, 12325.65 examples/s]Map (num_proc=1):  63%|██████▎   | 63000/100000 [00:06<00:02, 12556.91 examples/s]Map (num_proc=1):  65%|██████▌   | 65000/100000 [00:06<00:02, 12758.54 examples/s]Map (num_proc=1):  67%|██████▋   | 67000/100000 [00:06<00:02, 12849.84 examples/s]Map (num_proc=1):  69%|██████▉   | 69000/100000 [00:06<00:02, 12947.69 examples/s]Map (num_proc=1):  71%|███████   | 71000/100000 [00:07<00:02, 13008.87 examples/s]Map (num_proc=1):  73%|███████▎  | 73000/100000 [00:07<00:02, 13010.01 examples/s]Map (num_proc=1):  75%|███████▌  | 75000/100000 [00:07<00:01, 13065.67 examples/s]Map (num_proc=1):  77%|███████▋  | 77000/100000 [00:07<00:01, 13093.58 examples/s]Map (num_proc=1):  79%|███████▉  | 79000/100000 [00:07<00:01, 13125.70 examples/s]Map (num_proc=1):  81%|████████  | 81000/100000 [00:07<00:01, 13195.60 examples/s]Map (num_proc=1):  83%|████████▎ | 83000/100000 [00:08<00:01, 13139.95 examples/s]Map (num_proc=1):  85%|████████▌ | 85000/100000 [00:08<00:01, 13275.13 examples/s]Map (num_proc=1):  87%|████████▋ | 87000/100000 [00:08<00:00, 13159.28 examples/s]Map (num_proc=1):  89%|████████▉ | 89000/100000 [00:08<00:00, 13256.62 examples/s]Map (num_proc=1):  91%|█████████ | 91000/100000 [00:08<00:00, 13306.03 examples/s]Map (num_proc=1):  93%|█████████▎| 93000/100000 [00:08<00:00, 13304.32 examples/s]Map (num_proc=1):  95%|█████████▌| 95000/100000 [00:09<00:00, 10270.03 examples/s]Map (num_proc=1):  97%|█████████▋| 97000/100000 [00:09<00:00, 10950.21 examples/s]Map (num_proc=1):  99%|█████████▉| 99000/100000 [00:09<00:00, 11543.20 examples/s]Map (num_proc=1): 100%|██████████| 100000/100000 [00:09<00:00, 10045.19 examples/s]
Map (num_proc=1):   0%|          | 0/5000 [00:00<?, ? examples/s]Map (num_proc=1):  20%|██        | 1000/5000 [00:01<00:05, 690.38 examples/s]Map (num_proc=1):  40%|████      | 2000/5000 [00:01<00:01, 1505.32 examples/s]Map (num_proc=1):  60%|██████    | 3000/5000 [00:01<00:00, 2445.04 examples/s]Map (num_proc=1): 100%|██████████| 5000/5000 [00:01<00:00, 4490.05 examples/s]Map (num_proc=1): 100%|██████████| 5000/5000 [00:02<00:00, 2455.27 examples/s]
/home/mwei/NMT_projects/train.py:128: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Seq2SeqTrainer.__init__`. Use `processing_class` instead.
  trainer = Seq2SeqTrainer(
--- 4. Configuring training arguments ---
--- 5. Initializing Trainer and starting training ---
  0%|          | 0/31250 [00:00<?, ?it/s]/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/bitsandbytes/autograd/_functions.py:186: UserWarning: MatMul8bitLt: inputs will be cast from torch.float32 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/bitsandbytes/autograd/_functions.py:186: UserWarning: MatMul8bitLt: inputs will be cast from torch.bfloat16 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
  0%|          | 1/31250 [00:02<19:27:05,  2.24s/it]  0%|          | 2/31250 [00:03<15:15:34,  1.76s/it]  0%|          | 3/31250 [00:04<13:21:07,  1.54s/it]  0%|          | 4/31250 [00:06<12:26:19,  1.43s/it]  0%|          | 5/31250 [00:07<12:03:01,  1.39s/it]  0%|          | 6/31250 [00:08<11:56:10,  1.38s/it]  0%|          | 7/31250 [00:10<11:46:55,  1.36s/it]  0%|          | 8/31250 [00:11<11:30:04,  1.33s/it]  0%|          | 9/31250 [00:12<11:21:30,  1.31s/it]  0%|          | 10/31250 [00:13<11:15:28,  1.30s/it]  0%|          | 11/31250 [00:15<11:11:20,  1.29s/it]  0%|          | 12/31250 [00:16<11:03:11,  1.27s/it]  0%|          | 13/31250 [00:17<10:55:33,  1.26s/it]  0%|          | 14/31250 [00:18<10:49:18,  1.25s/it]  0%|          | 15/31250 [00:20<10:48:52,  1.25s/it]  0%|          | 16/31250 [00:21<10:42:30,  1.23s/it]  0%|          | 17/31250 [00:22<10:46:24,  1.24s/it]  0%|          | 18/31250 [00:23<10:57:50,  1.26s/it]  0%|          | 19/31250 [00:25<10:49:40,  1.25s/it]  0%|          | 20/31250 [00:26<10:49:31,  1.25s/it]  0%|          | 21/31250 [00:27<10:46:02,  1.24s/it]  0%|          | 22/31250 [00:28<10:41:53,  1.23s/it]  0%|          | 23/31250 [00:30<10:38:45,  1.23s/it]  0%|          | 24/31250 [00:31<10:36:07,  1.22s/it]  0%|          | 25/31250 [00:32<10:34:11,  1.22s/it]  0%|          | 26/31250 [00:33<10:35:44,  1.22s/it]  0%|          | 27/31250 [00:34<10:33:41,  1.22s/it]  0%|          | 28/31250 [00:36<10:31:40,  1.21s/it]  0%|          | 29/31250 [00:37<10:29:50,  1.21s/it]  0%|          | 30/31250 [00:38<10:30:50,  1.21s/it]  0%|          | 31/31250 [00:39<10:30:17,  1.21s/it]  0%|          | 32/31250 [00:40<10:30:19,  1.21s/it]  0%|          | 33/31250 [00:42<10:32:08,  1.21s/it]  0%|          | 34/31250 [00:43<10:31:15,  1.21s/it]  0%|          | 35/31250 [00:44<10:29:10,  1.21s/it]  0%|          | 36/31250 [00:45<10:29:41,  1.21s/it]  0%|          | 37/31250 [00:47<10:28:10,  1.21s/it]  0%|          | 38/31250 [00:48<10:27:56,  1.21s/it]  0%|          | 39/31250 [00:49<10:27:20,  1.21s/it]  0%|          | 40/31250 [00:50<10:26:08,  1.20s/it]  0%|          | 41/31250 [00:51<10:26:01,  1.20s/it]  0%|          | 42/31250 [00:53<10:27:02,  1.21s/it]  0%|          | 43/31250 [00:54<10:26:57,  1.21s/it]  0%|          | 44/31250 [00:55<10:27:11,  1.21s/it]  0%|          | 45/31250 [00:56<10:26:39,  1.20s/it]  0%|          | 46/31250 [00:57<10:27:03,  1.21s/it]  0%|          | 47/31250 [00:59<10:26:12,  1.20s/it]  0%|          | 48/31250 [01:00<10:25:26,  1.20s/it]  0%|          | 49/31250 [01:01<10:24:45,  1.20s/it]  0%|          | 50/31250 [01:02<10:25:45,  1.20s/it]                                                       0%|          | 50/31250 [01:02<10:25:45,  1.20s/it]  0%|          | 51/31250 [01:03<10:26:30,  1.20s/it]  0%|          | 52/31250 [01:05<10:25:19,  1.20s/it]  0%|          | 53/31250 [01:06<10:25:16,  1.20s/it]  0%|          | 54/31250 [01:07<10:24:59,  1.20s/it]  0%|          | 55/31250 [01:08<10:25:12,  1.20s/it]  0%|          | 56/31250 [01:09<10:24:49,  1.20s/it]  0%|          | 57/31250 [01:11<10:24:07,  1.20s/it]  0%|          | 58/31250 [01:12<10:29:41,  1.21s/it]  0%|          | 59/31250 [01:13<10:30:10,  1.21s/it]  0%|          | 60/31250 [01:14<10:29:39,  1.21s/it]  0%|          | 61/31250 [01:15<10:29:51,  1.21s/it]  0%|          | 62/31250 [01:17<10:29:33,  1.21s/it]  0%|          | 63/31250 [01:18<10:28:22,  1.21s/it]  0%|          | 64/31250 [01:19<10:27:32,  1.21s/it]  0%|          | 65/31250 [01:20<10:28:29,  1.21s/it]  0%|          | 66/31250 [01:22<10:28:15,  1.21s/it]  0%|          | 67/31250 [01:23<10:27:04,  1.21s/it]  0%|          | 68/31250 [01:24<10:25:56,  1.20s/it]  0%|          | 69/31250 [01:25<10:24:56,  1.20s/it]  0%|          | 70/31250 [01:26<10:26:36,  1.21s/it]  0%|          | 71/31250 [01:28<10:25:21,  1.20s/it]  0%|          | 72/31250 [01:29<10:25:29,  1.20s/it]  0%|          | 73/31250 [01:30<10:25:17,  1.20s/it]  0%|          | 74/31250 [01:31<10:24:26,  1.20s/it]  0%|          | 75/31250 [01:32<10:24:04,  1.20s/it]  0%|          | 76/31250 [01:34<10:27:04,  1.21s/it]  0%|          | 77/31250 [01:35<10:27:37,  1.21s/it]  0%|          | 78/31250 [01:36<10:27:27,  1.21s/it]  0%|          | 79/31250 [01:37<10:26:23,  1.21s/it]  0%|          | 80/31250 [01:38<10:26:00,  1.21s/it]  0%|          | 81/31250 [01:40<10:25:23,  1.20s/it]  0%|          | 82/31250 [01:41<10:24:40,  1.20s/it]  0%|          | 83/31250 [01:42<10:24:13,  1.20s/it]  0%|          | 84/31250 [01:43<10:25:29,  1.20s/it]  0%|          | 85/31250 [01:44<10:24:21,  1.20s/it]  0%|          | 86/31250 [01:46<10:24:10,  1.20s/it]  0%|          | 87/31250 [01:47<10:24:14,  1.20s/it]  0%|          | 88/31250 [01:48<10:22:56,  1.20s/it]  0%|          | 89/31250 [01:49<10:22:44,  1.20s/it]  0%|          | 90/31250 [01:50<10:22:38,  1.20s/it]  0%|          | 91/31250 [01:52<10:22:24,  1.20s/it]  0%|          | 92/31250 [01:53<10:21:45,  1.20s/it]  0%|          | 93/31250 [01:54<10:21:24,  1.20s/it]  0%|          | 94/31250 [01:55<10:21:30,  1.20s/it]  0%|          | 95/31250 [01:56<10:21:36,  1.20s/it]  0%|          | 96/31250 [01:58<10:21:22,  1.20s/it]  0%|          | 97/31250 [01:59<10:23:10,  1.20s/it]  0%|          | 98/31250 [02:00<10:23:34,  1.20s/it]  0%|          | 99/31250 [02:01<10:23:04,  1.20s/it]  0%|          | 100/31250 [02:02<10:23:28,  1.20s/it]                                                        0%|          | 100/31250 [02:02<10:23:28,  1.20s/it]  0%|          | 101/31250 [02:04<10:22:56,  1.20s/it]  0%|          | 102/31250 [02:05<10:22:29,  1.20s/it]  0%|          | 103/31250 [02:06<10:21:51,  1.20s/it]  0%|          | 104/31250 [02:07<10:22:22,  1.20s/it]  0%|          | 105/31250 [02:08<10:22:45,  1.20s/it]  0%|          | 106/31250 [02:10<10:22:24,  1.20s/it]  0%|          | 107/31250 [02:11<10:24:21,  1.20s/it]  0%|          | 108/31250 [02:12<10:23:48,  1.20s/it]  0%|          | 109/31250 [02:13<10:23:53,  1.20s/it]  0%|          | 110/31250 [02:14<10:23:05,  1.20s/it]  0%|          | 111/31250 [02:16<10:22:03,  1.20s/it]  0%|          | 112/31250 [02:17<10:25:32,  1.21s/it]  0%|          | 113/31250 [02:18<10:25:07,  1.20s/it]  0%|          | 114/31250 [02:19<10:24:01,  1.20s/it]  0%|          | 115/31250 [02:20<10:23:46,  1.20s/it]  0%|          | 116/31250 [02:22<10:22:25,  1.20s/it]  0%|          | 117/31250 [02:23<10:22:12,  1.20s/it]  0%|          | 118/31250 [02:24<10:22:14,  1.20s/it]  0%|          | 119/31250 [02:25<10:22:37,  1.20s/it]  0%|          | 120/31250 [02:26<10:22:14,  1.20s/it]  0%|          | 121/31250 [02:28<10:22:24,  1.20s/it]  0%|          | 122/31250 [02:29<10:22:07,  1.20s/it]  0%|          | 123/31250 [02:30<10:21:52,  1.20s/it]  0%|          | 124/31250 [02:31<10:21:44,  1.20s/it]  0%|          | 125/31250 [02:32<10:21:13,  1.20s/it]  0%|          | 126/31250 [02:34<10:21:32,  1.20s/it]  0%|          | 127/31250 [02:35<10:21:10,  1.20s/it]  0%|          | 128/31250 [02:36<10:23:21,  1.20s/it]  0%|          | 129/31250 [02:37<10:22:39,  1.20s/it]  0%|          | 130/31250 [02:38<10:21:43,  1.20s/it]  0%|          | 131/31250 [02:40<10:21:42,  1.20s/it]  0%|          | 132/31250 [02:41<10:22:51,  1.20s/it]  0%|          | 133/31250 [02:42<10:21:57,  1.20s/it]  0%|          | 134/31250 [02:43<10:21:11,  1.20s/it]  0%|          | 135/31250 [02:44<10:21:20,  1.20s/it]  0%|          | 136/31250 [02:46<10:22:31,  1.20s/it]  0%|          | 137/31250 [02:47<10:24:10,  1.20s/it]  0%|          | 138/31250 [02:48<10:23:36,  1.20s/it]  0%|          | 139/31250 [02:49<10:22:55,  1.20s/it]  0%|          | 140/31250 [02:50<10:22:18,  1.20s/it]  0%|          | 141/31250 [02:52<10:21:21,  1.20s/it]Killed
