========== Language: am (amh_Ethi) ==========
----- Training am 1k -----
usage: train.py [-h] [--model_name MODEL_NAME]
                [--data_base_path DATA_BASE_PATH] --lang LANG
                --data_size DATA_SIZE --src_lang_code SRC_LANG_CODE
                [--tgt_lang_code TGT_LANG_CODE] [--epochs EPOCHS]
                [--batch_size BATCH_SIZE]
                [--accumulation_steps ACCUMULATION_STEPS]
                [--learning_rate LEARNING_RATE] [--eval_steps EVAL_STEPS]
train.py: error: unrecognized arguments: --data_dir ./final_data2/am/train_1k.tsv --validation_file ./final_data2/am/validation.tsv
✅ Finished training am-1k
----- Evaluating am 1k -----
--- Evaluating am 1k ---
⚠️  No best model found, loading latest checkpoint instead: ./am-1k-finetune/checkpoint-24
Traceback (most recent call last):
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
OSError: [Errno 113] No route to host

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 773, in urlopen
    self._prepare_proxy(conn)
    ~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 1042, in _prepare_proxy
    conn.connect()
    ~~~~~~~~~~~~^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connection.py", line 753, in connect
    self.sock = sock = self._new_conn()
                       ~~~~~~~~~~~~~~^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7fe51c1179d0>: Failed to establish a new connection: [Errno 113] No route to host

The above exception was the direct cause of the following exception:

urllib3.exceptions.ProxyError: ('Unable to connect to proxy', NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fe51c1179d0>: Failed to establish a new connection: [Errno 113] No route to host'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/adapters.py", line 644, in send
    resp = conn.urlopen(
        method=request.method,
    ...<9 lines>...
        chunked=chunked,
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='huggingface.co', port=443): Max retries exceeded with url: /facebook/nllb-200-distilled-600M/resolve/main/model.safetensors (Caused by ProxyError('Unable to connect to proxy', NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fe51c1179d0>: Failed to establish a new connection: [Errno 113] No route to host')))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/mwei/NMT_projects/evaluate.py", line 87, in <module>
    main(args)
    ~~~~^^^^^^
  File "/home/mwei/NMT_projects/evaluate.py", line 35, in main
    base_model = AutoModelForSeq2SeqLM.from_pretrained(
        "facebook/nllb-200-distilled-600M",
        quantization_config=quant_config,
        device_map="auto"
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/models/auto/auto_factory.py", line 604, in from_pretrained
    return model_class.from_pretrained(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        pretrained_model_name_or_path, *model_args, config=config, **hub_kwargs, **kwargs
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/modeling_utils.py", line 288, in _wrapper
    return func(*args, **kwargs)
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/modeling_utils.py", line 5030, in from_pretrained
    checkpoint_files, sharded_metadata = _get_resolved_checkpoint_files(
                                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        pretrained_model_name_or_path=pretrained_model_name_or_path,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<15 lines>...
        transformers_explicit_filename=transformers_explicit_filename,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/modeling_utils.py", line 1216, in _get_resolved_checkpoint_files
    not has_file(pretrained_model_name_or_path, safe_weights_name, **has_file_kwargs)
        ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/utils/hub.py", line 679, in has_file
    response = get_session().head(
        hf_hub_url(path_or_repo, filename=filename, revision=revision, repo_type=repo_type),
    ...<3 lines>...
        timeout=10,
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/sessions.py", line 624, in head
    return self.request("HEAD", url, **kwargs)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/huggingface_hub/utils/_http.py", line 96, in send
    return super().send(request, *args, **kwargs)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/adapters.py", line 671, in send
    raise ProxyError(e, request=request)
requests.exceptions.ProxyError: (MaxRetryError("HTTPSConnectionPool(host='huggingface.co', port=443): Max retries exceeded with url: /facebook/nllb-200-distilled-600M/resolve/main/model.safetensors (Caused by ProxyError('Unable to connect to proxy', NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fe51c1179d0>: Failed to establish a new connection: [Errno 113] No route to host')))"), '(Request ID: 1da7d1d9-91b9-4e9d-9280-7f38b05ba4b5)')
✅ Finished evaluating am-1k

----- Training am 5k -----
usage: train.py [-h] [--model_name MODEL_NAME]
                [--data_base_path DATA_BASE_PATH] --lang LANG
                --data_size DATA_SIZE --src_lang_code SRC_LANG_CODE
                [--tgt_lang_code TGT_LANG_CODE] [--epochs EPOCHS]
                [--batch_size BATCH_SIZE]
                [--accumulation_steps ACCUMULATION_STEPS]
                [--learning_rate LEARNING_RATE] [--eval_steps EVAL_STEPS]
train.py: error: unrecognized arguments: --data_dir ./final_data2/am/train_5k.tsv --validation_file ./final_data2/am/validation.tsv
✅ Finished training am-5k
----- Evaluating am 5k -----
--- Evaluating am 5k ---
⚠️  No best model found, loading latest checkpoint instead: ./am-5k-finetune/checkpoint-120
Traceback (most recent call last):
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
OSError: [Errno 113] No route to host

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 773, in urlopen
    self._prepare_proxy(conn)
    ~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 1042, in _prepare_proxy
    conn.connect()
    ~~~~~~~~~~~~^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connection.py", line 753, in connect
    self.sock = sock = self._new_conn()
                       ~~~~~~~~~~~~~~^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7f615b3139d0>: Failed to establish a new connection: [Errno 113] No route to host

The above exception was the direct cause of the following exception:

urllib3.exceptions.ProxyError: ('Unable to connect to proxy', NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f615b3139d0>: Failed to establish a new connection: [Errno 113] No route to host'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/adapters.py", line 644, in send
    resp = conn.urlopen(
        method=request.method,
    ...<9 lines>...
        chunked=chunked,
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='huggingface.co', port=443): Max retries exceeded with url: /facebook/nllb-200-distilled-600M/resolve/main/model.safetensors (Caused by ProxyError('Unable to connect to proxy', NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f615b3139d0>: Failed to establish a new connection: [Errno 113] No route to host')))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/mwei/NMT_projects/evaluate.py", line 87, in <module>
    main(args)
    ~~~~^^^^^^
  File "/home/mwei/NMT_projects/evaluate.py", line 35, in main
    base_model = AutoModelForSeq2SeqLM.from_pretrained(
        "facebook/nllb-200-distilled-600M",
        quantization_config=quant_config,
        device_map="auto"
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/models/auto/auto_factory.py", line 604, in from_pretrained
    return model_class.from_pretrained(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        pretrained_model_name_or_path, *model_args, config=config, **hub_kwargs, **kwargs
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/modeling_utils.py", line 288, in _wrapper
    return func(*args, **kwargs)
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/modeling_utils.py", line 5030, in from_pretrained
    checkpoint_files, sharded_metadata = _get_resolved_checkpoint_files(
                                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        pretrained_model_name_or_path=pretrained_model_name_or_path,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<15 lines>...
        transformers_explicit_filename=transformers_explicit_filename,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/modeling_utils.py", line 1216, in _get_resolved_checkpoint_files
    not has_file(pretrained_model_name_or_path, safe_weights_name, **has_file_kwargs)
        ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/utils/hub.py", line 679, in has_file
    response = get_session().head(
        hf_hub_url(path_or_repo, filename=filename, revision=revision, repo_type=repo_type),
    ...<3 lines>...
        timeout=10,
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/sessions.py", line 624, in head
    return self.request("HEAD", url, **kwargs)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/huggingface_hub/utils/_http.py", line 96, in send
    return super().send(request, *args, **kwargs)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/adapters.py", line 671, in send
    raise ProxyError(e, request=request)
requests.exceptions.ProxyError: (MaxRetryError("HTTPSConnectionPool(host='huggingface.co', port=443): Max retries exceeded with url: /facebook/nllb-200-distilled-600M/resolve/main/model.safetensors (Caused by ProxyError('Unable to connect to proxy', NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f615b3139d0>: Failed to establish a new connection: [Errno 113] No route to host')))"), '(Request ID: 312d4cc7-a1d8-4f4a-85fb-0eac02cc9a8a)')
✅ Finished evaluating am-5k

----- Training am 25k -----
usage: train.py [-h] [--model_name MODEL_NAME]
                [--data_base_path DATA_BASE_PATH] --lang LANG
                --data_size DATA_SIZE --src_lang_code SRC_LANG_CODE
                [--tgt_lang_code TGT_LANG_CODE] [--epochs EPOCHS]
                [--batch_size BATCH_SIZE]
                [--accumulation_steps ACCUMULATION_STEPS]
                [--learning_rate LEARNING_RATE] [--eval_steps EVAL_STEPS]
train.py: error: unrecognized arguments: --data_dir ./final_data2/am/train_25k.tsv --validation_file ./final_data2/am/validation.tsv
✅ Finished training am-25k
----- Evaluating am 25k -----
--- Evaluating am 25k ---
⚠️  No best model found, loading latest checkpoint instead: ./am-25k-finetune/checkpoint-588
Traceback (most recent call last):
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
OSError: [Errno 113] No route to host

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 773, in urlopen
    self._prepare_proxy(conn)
    ~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 1042, in _prepare_proxy
    conn.connect()
    ~~~~~~~~~~~~^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connection.py", line 753, in connect
    self.sock = sock = self._new_conn()
                       ~~~~~~~~~~~~~~^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7fde926139d0>: Failed to establish a new connection: [Errno 113] No route to host

The above exception was the direct cause of the following exception:

urllib3.exceptions.ProxyError: ('Unable to connect to proxy', NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fde926139d0>: Failed to establish a new connection: [Errno 113] No route to host'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/adapters.py", line 644, in send
    resp = conn.urlopen(
        method=request.method,
    ...<9 lines>...
        chunked=chunked,
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='huggingface.co', port=443): Max retries exceeded with url: /facebook/nllb-200-distilled-600M/resolve/main/model.safetensors (Caused by ProxyError('Unable to connect to proxy', NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fde926139d0>: Failed to establish a new connection: [Errno 113] No route to host')))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/mwei/NMT_projects/evaluate.py", line 87, in <module>
    main(args)
    ~~~~^^^^^^
  File "/home/mwei/NMT_projects/evaluate.py", line 35, in main
    base_model = AutoModelForSeq2SeqLM.from_pretrained(
        "facebook/nllb-200-distilled-600M",
        quantization_config=quant_config,
        device_map="auto"
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/models/auto/auto_factory.py", line 604, in from_pretrained
    return model_class.from_pretrained(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        pretrained_model_name_or_path, *model_args, config=config, **hub_kwargs, **kwargs
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/modeling_utils.py", line 288, in _wrapper
    return func(*args, **kwargs)
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/modeling_utils.py", line 5030, in from_pretrained
    checkpoint_files, sharded_metadata = _get_resolved_checkpoint_files(
                                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        pretrained_model_name_or_path=pretrained_model_name_or_path,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<15 lines>...
        transformers_explicit_filename=transformers_explicit_filename,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/modeling_utils.py", line 1216, in _get_resolved_checkpoint_files
    not has_file(pretrained_model_name_or_path, safe_weights_name, **has_file_kwargs)
        ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/utils/hub.py", line 679, in has_file
    response = get_session().head(
        hf_hub_url(path_or_repo, filename=filename, revision=revision, repo_type=repo_type),
    ...<3 lines>...
        timeout=10,
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/sessions.py", line 624, in head
    return self.request("HEAD", url, **kwargs)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/huggingface_hub/utils/_http.py", line 96, in send
    return super().send(request, *args, **kwargs)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/adapters.py", line 671, in send
    raise ProxyError(e, request=request)
requests.exceptions.ProxyError: (MaxRetryError("HTTPSConnectionPool(host='huggingface.co', port=443): Max retries exceeded with url: /facebook/nllb-200-distilled-600M/resolve/main/model.safetensors (Caused by ProxyError('Unable to connect to proxy', NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fde926139d0>: Failed to establish a new connection: [Errno 113] No route to host')))"), '(Request ID: a3569517-6184-4700-969e-f6e42115b68f)')
✅ Finished evaluating am-25k

----- Training am 100k -----
usage: train.py [-h] [--model_name MODEL_NAME]
                [--data_base_path DATA_BASE_PATH] --lang LANG
                --data_size DATA_SIZE --src_lang_code SRC_LANG_CODE
                [--tgt_lang_code TGT_LANG_CODE] [--epochs EPOCHS]
                [--batch_size BATCH_SIZE]
                [--accumulation_steps ACCUMULATION_STEPS]
                [--learning_rate LEARNING_RATE] [--eval_steps EVAL_STEPS]
train.py: error: unrecognized arguments: --data_dir ./final_data2/am/train_100k.tsv --validation_file ./final_data2/am/validation.tsv
✅ Finished training am-100k
----- Evaluating am 100k -----
--- Evaluating am 100k ---
⚠️  No best model found, loading latest checkpoint instead: ./am-100k-finetune/checkpoint-2346
Traceback (most recent call last):
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
OSError: [Errno 113] No route to host

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 773, in urlopen
    self._prepare_proxy(conn)
    ~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 1042, in _prepare_proxy
    conn.connect()
    ~~~~~~~~~~~~^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connection.py", line 753, in connect
    self.sock = sock = self._new_conn()
                       ~~~~~~~~~~~~~~^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7f0b315179d0>: Failed to establish a new connection: [Errno 113] No route to host

The above exception was the direct cause of the following exception:

urllib3.exceptions.ProxyError: ('Unable to connect to proxy', NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f0b315179d0>: Failed to establish a new connection: [Errno 113] No route to host'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/adapters.py", line 644, in send
    resp = conn.urlopen(
        method=request.method,
    ...<9 lines>...
        chunked=chunked,
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='huggingface.co', port=443): Max retries exceeded with url: /facebook/nllb-200-distilled-600M/resolve/main/model.safetensors (Caused by ProxyError('Unable to connect to proxy', NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f0b315179d0>: Failed to establish a new connection: [Errno 113] No route to host')))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/mwei/NMT_projects/evaluate.py", line 87, in <module>
    main(args)
    ~~~~^^^^^^
  File "/home/mwei/NMT_projects/evaluate.py", line 35, in main
    base_model = AutoModelForSeq2SeqLM.from_pretrained(
        "facebook/nllb-200-distilled-600M",
        quantization_config=quant_config,
        device_map="auto"
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/models/auto/auto_factory.py", line 604, in from_pretrained
    return model_class.from_pretrained(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        pretrained_model_name_or_path, *model_args, config=config, **hub_kwargs, **kwargs
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/modeling_utils.py", line 288, in _wrapper
    return func(*args, **kwargs)
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/modeling_utils.py", line 5030, in from_pretrained
    checkpoint_files, sharded_metadata = _get_resolved_checkpoint_files(
                                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        pretrained_model_name_or_path=pretrained_model_name_or_path,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<15 lines>...
        transformers_explicit_filename=transformers_explicit_filename,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/modeling_utils.py", line 1216, in _get_resolved_checkpoint_files
    not has_file(pretrained_model_name_or_path, safe_weights_name, **has_file_kwargs)
        ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/utils/hub.py", line 679, in has_file
    response = get_session().head(
        hf_hub_url(path_or_repo, filename=filename, revision=revision, repo_type=repo_type),
    ...<3 lines>...
        timeout=10,
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/sessions.py", line 624, in head
    return self.request("HEAD", url, **kwargs)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/huggingface_hub/utils/_http.py", line 96, in send
    return super().send(request, *args, **kwargs)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/adapters.py", line 671, in send
    raise ProxyError(e, request=request)
requests.exceptions.ProxyError: (MaxRetryError("HTTPSConnectionPool(host='huggingface.co', port=443): Max retries exceeded with url: /facebook/nllb-200-distilled-600M/resolve/main/model.safetensors (Caused by ProxyError('Unable to connect to proxy', NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f0b315179d0>: Failed to establish a new connection: [Errno 113] No route to host')))"), '(Request ID: 2bee8da6-be2c-4837-b496-8a6560603c91)')
✅ Finished evaluating am-100k

----- Training am 500k -----
usage: train.py [-h] [--model_name MODEL_NAME]
                [--data_base_path DATA_BASE_PATH] --lang LANG
                --data_size DATA_SIZE --src_lang_code SRC_LANG_CODE
                [--tgt_lang_code TGT_LANG_CODE] [--epochs EPOCHS]
                [--batch_size BATCH_SIZE]
                [--accumulation_steps ACCUMULATION_STEPS]
                [--learning_rate LEARNING_RATE] [--eval_steps EVAL_STEPS]
train.py: error: unrecognized arguments: --data_dir ./final_data2/am/train_500k.tsv --validation_file ./final_data2/am/validation.tsv
✅ Finished training am-500k
----- Evaluating am 500k -----
--- Evaluating am 500k ---
Traceback (most recent call last):
  File "/home/mwei/NMT_projects/evaluate.py", line 87, in <module>
    main(args)
    ~~~~^^^^^^
  File "/home/mwei/NMT_projects/evaluate.py", line 32, in main
    model_path = find_best_or_latest_checkpoint(model_path)
  File "/home/mwei/NMT_projects/evaluate.py", line 15, in find_best_or_latest_checkpoint
    any(fname.startswith("pytorch_model") for fname in os.listdir(model_path_base)):
                                                       ~~~~~~~~~~^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: './am-500k-finetune'
✅ Finished evaluating am-500k

----- Training am 1M -----
usage: train.py [-h] [--model_name MODEL_NAME]
                [--data_base_path DATA_BASE_PATH] --lang LANG
                --data_size DATA_SIZE --src_lang_code SRC_LANG_CODE
                [--tgt_lang_code TGT_LANG_CODE] [--epochs EPOCHS]
                [--batch_size BATCH_SIZE]
                [--accumulation_steps ACCUMULATION_STEPS]
                [--learning_rate LEARNING_RATE] [--eval_steps EVAL_STEPS]
train.py: error: unrecognized arguments: --data_dir ./final_data2/am/train_1M.tsv --validation_file ./final_data2/am/validation.tsv
✅ Finished training am-1M
----- Evaluating am 1M -----
--- Evaluating am 1M ---
Traceback (most recent call last):
  File "/home/mwei/NMT_projects/evaluate.py", line 87, in <module>
    main(args)
    ~~~~^^^^^^
  File "/home/mwei/NMT_projects/evaluate.py", line 32, in main
    model_path = find_best_or_latest_checkpoint(model_path)
  File "/home/mwei/NMT_projects/evaluate.py", line 15, in find_best_or_latest_checkpoint
    any(fname.startswith("pytorch_model") for fname in os.listdir(model_path_base)):
                                                       ~~~~~~~~~~^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: './am-1M-finetune'
✅ Finished evaluating am-1M

========== Language: sw (swh_Latn) ==========
----- Training sw 1k -----
usage: train.py [-h] [--model_name MODEL_NAME]
                [--data_base_path DATA_BASE_PATH] --lang LANG
                --data_size DATA_SIZE --src_lang_code SRC_LANG_CODE
                [--tgt_lang_code TGT_LANG_CODE] [--epochs EPOCHS]
                [--batch_size BATCH_SIZE]
                [--accumulation_steps ACCUMULATION_STEPS]
                [--learning_rate LEARNING_RATE] [--eval_steps EVAL_STEPS]
train.py: error: unrecognized arguments: --data_dir ./final_data2/sw/train_1k.tsv --validation_file ./final_data2/sw/validation.tsv
✅ Finished training sw-1k
----- Evaluating sw 1k -----
--- Evaluating sw 1k ---
⚠️  No best model found, loading latest checkpoint instead: ./sw-1k-finetune/checkpoint-24
Traceback (most recent call last):
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
OSError: [Errno 113] No route to host

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 773, in urlopen
    self._prepare_proxy(conn)
    ~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 1042, in _prepare_proxy
    conn.connect()
    ~~~~~~~~~~~~^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connection.py", line 753, in connect
    self.sock = sock = self._new_conn()
                       ~~~~~~~~~~~~~~^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7fa26ffc79d0>: Failed to establish a new connection: [Errno 113] No route to host

The above exception was the direct cause of the following exception:

urllib3.exceptions.ProxyError: ('Unable to connect to proxy', NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fa26ffc79d0>: Failed to establish a new connection: [Errno 113] No route to host'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/adapters.py", line 644, in send
    resp = conn.urlopen(
        method=request.method,
    ...<9 lines>...
        chunked=chunked,
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='huggingface.co', port=443): Max retries exceeded with url: /facebook/nllb-200-distilled-600M/resolve/main/model.safetensors (Caused by ProxyError('Unable to connect to proxy', NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fa26ffc79d0>: Failed to establish a new connection: [Errno 113] No route to host')))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/mwei/NMT_projects/evaluate.py", line 87, in <module>
    main(args)
    ~~~~^^^^^^
  File "/home/mwei/NMT_projects/evaluate.py", line 35, in main
    base_model = AutoModelForSeq2SeqLM.from_pretrained(
        "facebook/nllb-200-distilled-600M",
        quantization_config=quant_config,
        device_map="auto"
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/models/auto/auto_factory.py", line 604, in from_pretrained
    return model_class.from_pretrained(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        pretrained_model_name_or_path, *model_args, config=config, **hub_kwargs, **kwargs
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/modeling_utils.py", line 288, in _wrapper
    return func(*args, **kwargs)
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/modeling_utils.py", line 5030, in from_pretrained
    checkpoint_files, sharded_metadata = _get_resolved_checkpoint_files(
                                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        pretrained_model_name_or_path=pretrained_model_name_or_path,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<15 lines>...
        transformers_explicit_filename=transformers_explicit_filename,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/modeling_utils.py", line 1216, in _get_resolved_checkpoint_files
    not has_file(pretrained_model_name_or_path, safe_weights_name, **has_file_kwargs)
        ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/utils/hub.py", line 679, in has_file
    response = get_session().head(
        hf_hub_url(path_or_repo, filename=filename, revision=revision, repo_type=repo_type),
    ...<3 lines>...
        timeout=10,
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/sessions.py", line 624, in head
    return self.request("HEAD", url, **kwargs)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/huggingface_hub/utils/_http.py", line 96, in send
    return super().send(request, *args, **kwargs)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/adapters.py", line 671, in send
    raise ProxyError(e, request=request)
requests.exceptions.ProxyError: (MaxRetryError("HTTPSConnectionPool(host='huggingface.co', port=443): Max retries exceeded with url: /facebook/nllb-200-distilled-600M/resolve/main/model.safetensors (Caused by ProxyError('Unable to connect to proxy', NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fa26ffc79d0>: Failed to establish a new connection: [Errno 113] No route to host')))"), '(Request ID: 1da52f12-f654-44c0-9942-8c9c55375f32)')
✅ Finished evaluating sw-1k

----- Training sw 5k -----
usage: train.py [-h] [--model_name MODEL_NAME]
                [--data_base_path DATA_BASE_PATH] --lang LANG
                --data_size DATA_SIZE --src_lang_code SRC_LANG_CODE
                [--tgt_lang_code TGT_LANG_CODE] [--epochs EPOCHS]
                [--batch_size BATCH_SIZE]
                [--accumulation_steps ACCUMULATION_STEPS]
                [--learning_rate LEARNING_RATE] [--eval_steps EVAL_STEPS]
train.py: error: unrecognized arguments: --data_dir ./final_data2/sw/train_5k.tsv --validation_file ./final_data2/sw/validation.tsv
✅ Finished training sw-5k
----- Evaluating sw 5k -----
--- Evaluating sw 5k ---
⚠️  No best model found, loading latest checkpoint instead: ./sw-5k-finetune/checkpoint-120
Traceback (most recent call last):
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
OSError: [Errno 113] No route to host

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 773, in urlopen
    self._prepare_proxy(conn)
    ~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 1042, in _prepare_proxy
    conn.connect()
    ~~~~~~~~~~~~^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connection.py", line 753, in connect
    self.sock = sock = self._new_conn()
                       ~~~~~~~~~~~~~~^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7fe56cfcf9d0>: Failed to establish a new connection: [Errno 113] No route to host

The above exception was the direct cause of the following exception:

urllib3.exceptions.ProxyError: ('Unable to connect to proxy', NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fe56cfcf9d0>: Failed to establish a new connection: [Errno 113] No route to host'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/adapters.py", line 644, in send
    resp = conn.urlopen(
        method=request.method,
    ...<9 lines>...
        chunked=chunked,
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='huggingface.co', port=443): Max retries exceeded with url: /facebook/nllb-200-distilled-600M/resolve/main/model.safetensors (Caused by ProxyError('Unable to connect to proxy', NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fe56cfcf9d0>: Failed to establish a new connection: [Errno 113] No route to host')))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/mwei/NMT_projects/evaluate.py", line 87, in <module>
    main(args)
    ~~~~^^^^^^
  File "/home/mwei/NMT_projects/evaluate.py", line 35, in main
    base_model = AutoModelForSeq2SeqLM.from_pretrained(
        "facebook/nllb-200-distilled-600M",
        quantization_config=quant_config,
        device_map="auto"
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/models/auto/auto_factory.py", line 604, in from_pretrained
    return model_class.from_pretrained(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        pretrained_model_name_or_path, *model_args, config=config, **hub_kwargs, **kwargs
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/modeling_utils.py", line 288, in _wrapper
    return func(*args, **kwargs)
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/modeling_utils.py", line 5030, in from_pretrained
    checkpoint_files, sharded_metadata = _get_resolved_checkpoint_files(
                                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        pretrained_model_name_or_path=pretrained_model_name_or_path,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<15 lines>...
        transformers_explicit_filename=transformers_explicit_filename,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/modeling_utils.py", line 1216, in _get_resolved_checkpoint_files
    not has_file(pretrained_model_name_or_path, safe_weights_name, **has_file_kwargs)
        ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/utils/hub.py", line 679, in has_file
    response = get_session().head(
        hf_hub_url(path_or_repo, filename=filename, revision=revision, repo_type=repo_type),
    ...<3 lines>...
        timeout=10,
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/sessions.py", line 624, in head
    return self.request("HEAD", url, **kwargs)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/huggingface_hub/utils/_http.py", line 96, in send
    return super().send(request, *args, **kwargs)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/adapters.py", line 671, in send
    raise ProxyError(e, request=request)
requests.exceptions.ProxyError: (MaxRetryError("HTTPSConnectionPool(host='huggingface.co', port=443): Max retries exceeded with url: /facebook/nllb-200-distilled-600M/resolve/main/model.safetensors (Caused by ProxyError('Unable to connect to proxy', NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fe56cfcf9d0>: Failed to establish a new connection: [Errno 113] No route to host')))"), '(Request ID: f8cecc5e-363c-4d53-a1db-ea72d5e5baca)')
✅ Finished evaluating sw-5k

----- Training sw 25k -----
usage: train.py [-h] [--model_name MODEL_NAME]
                [--data_base_path DATA_BASE_PATH] --lang LANG
                --data_size DATA_SIZE --src_lang_code SRC_LANG_CODE
                [--tgt_lang_code TGT_LANG_CODE] [--epochs EPOCHS]
                [--batch_size BATCH_SIZE]
                [--accumulation_steps ACCUMULATION_STEPS]
                [--learning_rate LEARNING_RATE] [--eval_steps EVAL_STEPS]
train.py: error: unrecognized arguments: --data_dir ./final_data2/sw/train_25k.tsv --validation_file ./final_data2/sw/validation.tsv
✅ Finished training sw-25k
----- Evaluating sw 25k -----
--- Evaluating sw 25k ---
⚠️  No best model found, loading latest checkpoint instead: ./sw-25k-finetune/checkpoint-588
Traceback (most recent call last):
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
OSError: [Errno 113] No route to host

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 773, in urlopen
    self._prepare_proxy(conn)
    ~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 1042, in _prepare_proxy
    conn.connect()
    ~~~~~~~~~~~~^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connection.py", line 753, in connect
    self.sock = sock = self._new_conn()
                       ~~~~~~~~~~~~~~^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7f11baf8b9d0>: Failed to establish a new connection: [Errno 113] No route to host

The above exception was the direct cause of the following exception:

urllib3.exceptions.ProxyError: ('Unable to connect to proxy', NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f11baf8b9d0>: Failed to establish a new connection: [Errno 113] No route to host'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/adapters.py", line 644, in send
    resp = conn.urlopen(
        method=request.method,
    ...<9 lines>...
        chunked=chunked,
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='huggingface.co', port=443): Max retries exceeded with url: /facebook/nllb-200-distilled-600M/resolve/main/model.safetensors (Caused by ProxyError('Unable to connect to proxy', NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f11baf8b9d0>: Failed to establish a new connection: [Errno 113] No route to host')))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/mwei/NMT_projects/evaluate.py", line 87, in <module>
    main(args)
    ~~~~^^^^^^
  File "/home/mwei/NMT_projects/evaluate.py", line 35, in main
    base_model = AutoModelForSeq2SeqLM.from_pretrained(
        "facebook/nllb-200-distilled-600M",
        quantization_config=quant_config,
        device_map="auto"
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/models/auto/auto_factory.py", line 604, in from_pretrained
    return model_class.from_pretrained(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        pretrained_model_name_or_path, *model_args, config=config, **hub_kwargs, **kwargs
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/modeling_utils.py", line 288, in _wrapper
    return func(*args, **kwargs)
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/modeling_utils.py", line 5030, in from_pretrained
    checkpoint_files, sharded_metadata = _get_resolved_checkpoint_files(
                                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        pretrained_model_name_or_path=pretrained_model_name_or_path,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<15 lines>...
        transformers_explicit_filename=transformers_explicit_filename,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/modeling_utils.py", line 1216, in _get_resolved_checkpoint_files
    not has_file(pretrained_model_name_or_path, safe_weights_name, **has_file_kwargs)
        ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/utils/hub.py", line 679, in has_file
    response = get_session().head(
        hf_hub_url(path_or_repo, filename=filename, revision=revision, repo_type=repo_type),
    ...<3 lines>...
        timeout=10,
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/sessions.py", line 624, in head
    return self.request("HEAD", url, **kwargs)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/huggingface_hub/utils/_http.py", line 96, in send
    return super().send(request, *args, **kwargs)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/adapters.py", line 671, in send
    raise ProxyError(e, request=request)
requests.exceptions.ProxyError: (MaxRetryError("HTTPSConnectionPool(host='huggingface.co', port=443): Max retries exceeded with url: /facebook/nllb-200-distilled-600M/resolve/main/model.safetensors (Caused by ProxyError('Unable to connect to proxy', NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f11baf8b9d0>: Failed to establish a new connection: [Errno 113] No route to host')))"), '(Request ID: ed41da40-ac3a-4434-bf58-bbd9c9a27fac)')
✅ Finished evaluating sw-25k

----- Training sw 100k -----
usage: train.py [-h] [--model_name MODEL_NAME]
                [--data_base_path DATA_BASE_PATH] --lang LANG
                --data_size DATA_SIZE --src_lang_code SRC_LANG_CODE
                [--tgt_lang_code TGT_LANG_CODE] [--epochs EPOCHS]
                [--batch_size BATCH_SIZE]
                [--accumulation_steps ACCUMULATION_STEPS]
                [--learning_rate LEARNING_RATE] [--eval_steps EVAL_STEPS]
train.py: error: unrecognized arguments: --data_dir ./final_data2/sw/train_100k.tsv --validation_file ./final_data2/sw/validation.tsv
✅ Finished training sw-100k
----- Evaluating sw 100k -----
--- Evaluating sw 100k ---
⚠️  No best model found, loading latest checkpoint instead: ./sw-100k-finetune/checkpoint-2346
Traceback (most recent call last):
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
OSError: [Errno 113] No route to host

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 773, in urlopen
    self._prepare_proxy(conn)
    ~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 1042, in _prepare_proxy
    conn.connect()
    ~~~~~~~~~~~~^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connection.py", line 753, in connect
    self.sock = sock = self._new_conn()
                       ~~~~~~~~~~~~~~^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7f44eda239d0>: Failed to establish a new connection: [Errno 113] No route to host

The above exception was the direct cause of the following exception:

urllib3.exceptions.ProxyError: ('Unable to connect to proxy', NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f44eda239d0>: Failed to establish a new connection: [Errno 113] No route to host'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/adapters.py", line 644, in send
    resp = conn.urlopen(
        method=request.method,
    ...<9 lines>...
        chunked=chunked,
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='huggingface.co', port=443): Max retries exceeded with url: /facebook/nllb-200-distilled-600M/resolve/main/model.safetensors (Caused by ProxyError('Unable to connect to proxy', NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f44eda239d0>: Failed to establish a new connection: [Errno 113] No route to host')))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/mwei/NMT_projects/evaluate.py", line 87, in <module>
    main(args)
    ~~~~^^^^^^
  File "/home/mwei/NMT_projects/evaluate.py", line 35, in main
    base_model = AutoModelForSeq2SeqLM.from_pretrained(
        "facebook/nllb-200-distilled-600M",
        quantization_config=quant_config,
        device_map="auto"
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/models/auto/auto_factory.py", line 604, in from_pretrained
    return model_class.from_pretrained(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        pretrained_model_name_or_path, *model_args, config=config, **hub_kwargs, **kwargs
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/modeling_utils.py", line 288, in _wrapper
    return func(*args, **kwargs)
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/modeling_utils.py", line 5030, in from_pretrained
    checkpoint_files, sharded_metadata = _get_resolved_checkpoint_files(
                                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        pretrained_model_name_or_path=pretrained_model_name_or_path,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<15 lines>...
        transformers_explicit_filename=transformers_explicit_filename,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/modeling_utils.py", line 1216, in _get_resolved_checkpoint_files
    not has_file(pretrained_model_name_or_path, safe_weights_name, **has_file_kwargs)
        ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/utils/hub.py", line 679, in has_file
    response = get_session().head(
        hf_hub_url(path_or_repo, filename=filename, revision=revision, repo_type=repo_type),
    ...<3 lines>...
        timeout=10,
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/sessions.py", line 624, in head
    return self.request("HEAD", url, **kwargs)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/huggingface_hub/utils/_http.py", line 96, in send
    return super().send(request, *args, **kwargs)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/adapters.py", line 671, in send
    raise ProxyError(e, request=request)
requests.exceptions.ProxyError: (MaxRetryError("HTTPSConnectionPool(host='huggingface.co', port=443): Max retries exceeded with url: /facebook/nllb-200-distilled-600M/resolve/main/model.safetensors (Caused by ProxyError('Unable to connect to proxy', NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f44eda239d0>: Failed to establish a new connection: [Errno 113] No route to host')))"), '(Request ID: 84595e2d-b62c-4c99-9731-13e35bf8069e)')
✅ Finished evaluating sw-100k

----- Training sw 500k -----
usage: train.py [-h] [--model_name MODEL_NAME]
                [--data_base_path DATA_BASE_PATH] --lang LANG
                --data_size DATA_SIZE --src_lang_code SRC_LANG_CODE
                [--tgt_lang_code TGT_LANG_CODE] [--epochs EPOCHS]
                [--batch_size BATCH_SIZE]
                [--accumulation_steps ACCUMULATION_STEPS]
                [--learning_rate LEARNING_RATE] [--eval_steps EVAL_STEPS]
train.py: error: unrecognized arguments: --data_dir ./final_data2/sw/train_500k.tsv --validation_file ./final_data2/sw/validation.tsv
✅ Finished training sw-500k
----- Evaluating sw 500k -----
--- Evaluating sw 500k ---
Traceback (most recent call last):
  File "/home/mwei/NMT_projects/evaluate.py", line 87, in <module>
    main(args)
    ~~~~^^^^^^
  File "/home/mwei/NMT_projects/evaluate.py", line 32, in main
    model_path = find_best_or_latest_checkpoint(model_path)
  File "/home/mwei/NMT_projects/evaluate.py", line 15, in find_best_or_latest_checkpoint
    any(fname.startswith("pytorch_model") for fname in os.listdir(model_path_base)):
                                                       ~~~~~~~~~~^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: './sw-500k-finetune'
✅ Finished evaluating sw-500k

----- Training sw 1M -----
usage: train.py [-h] [--model_name MODEL_NAME]
                [--data_base_path DATA_BASE_PATH] --lang LANG
                --data_size DATA_SIZE --src_lang_code SRC_LANG_CODE
                [--tgt_lang_code TGT_LANG_CODE] [--epochs EPOCHS]
                [--batch_size BATCH_SIZE]
                [--accumulation_steps ACCUMULATION_STEPS]
                [--learning_rate LEARNING_RATE] [--eval_steps EVAL_STEPS]
train.py: error: unrecognized arguments: --data_dir ./final_data2/sw/train_1M.tsv --validation_file ./final_data2/sw/validation.tsv
✅ Finished training sw-1M
----- Evaluating sw 1M -----
--- Evaluating sw 1M ---
Traceback (most recent call last):
  File "/home/mwei/NMT_projects/evaluate.py", line 87, in <module>
    main(args)
    ~~~~^^^^^^
  File "/home/mwei/NMT_projects/evaluate.py", line 32, in main
    model_path = find_best_or_latest_checkpoint(model_path)
  File "/home/mwei/NMT_projects/evaluate.py", line 15, in find_best_or_latest_checkpoint
    any(fname.startswith("pytorch_model") for fname in os.listdir(model_path_base)):
                                                       ~~~~~~~~~~^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: './sw-1M-finetune'
✅ Finished evaluating sw-1M

========== Language: zu (zul_Latn) ==========
----- Training zu 1k -----
usage: train.py [-h] [--model_name MODEL_NAME]
                [--data_base_path DATA_BASE_PATH] --lang LANG
                --data_size DATA_SIZE --src_lang_code SRC_LANG_CODE
                [--tgt_lang_code TGT_LANG_CODE] [--epochs EPOCHS]
                [--batch_size BATCH_SIZE]
                [--accumulation_steps ACCUMULATION_STEPS]
                [--learning_rate LEARNING_RATE] [--eval_steps EVAL_STEPS]
train.py: error: unrecognized arguments: --data_dir ./final_data2/zu/train_1k.tsv --validation_file ./final_data2/zu/validation.tsv
✅ Finished training zu-1k
----- Evaluating zu 1k -----
--- Evaluating zu 1k ---
⚠️  No best model found, loading latest checkpoint instead: ./zu-1k-finetune/checkpoint-24
Traceback (most recent call last):
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
OSError: [Errno 113] No route to host

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 773, in urlopen
    self._prepare_proxy(conn)
    ~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 1042, in _prepare_proxy
    conn.connect()
    ~~~~~~~~~~~~^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connection.py", line 753, in connect
    self.sock = sock = self._new_conn()
                       ~~~~~~~~~~~~~~^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7fe3ee7d79d0>: Failed to establish a new connection: [Errno 113] No route to host

The above exception was the direct cause of the following exception:

urllib3.exceptions.ProxyError: ('Unable to connect to proxy', NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fe3ee7d79d0>: Failed to establish a new connection: [Errno 113] No route to host'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/adapters.py", line 644, in send
    resp = conn.urlopen(
        method=request.method,
    ...<9 lines>...
        chunked=chunked,
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='huggingface.co', port=443): Max retries exceeded with url: /facebook/nllb-200-distilled-600M/resolve/main/model.safetensors (Caused by ProxyError('Unable to connect to proxy', NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fe3ee7d79d0>: Failed to establish a new connection: [Errno 113] No route to host')))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/mwei/NMT_projects/evaluate.py", line 87, in <module>
    main(args)
    ~~~~^^^^^^
  File "/home/mwei/NMT_projects/evaluate.py", line 35, in main
    base_model = AutoModelForSeq2SeqLM.from_pretrained(
        "facebook/nllb-200-distilled-600M",
        quantization_config=quant_config,
        device_map="auto"
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/models/auto/auto_factory.py", line 604, in from_pretrained
    return model_class.from_pretrained(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        pretrained_model_name_or_path, *model_args, config=config, **hub_kwargs, **kwargs
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/modeling_utils.py", line 288, in _wrapper
    return func(*args, **kwargs)
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/modeling_utils.py", line 5030, in from_pretrained
    checkpoint_files, sharded_metadata = _get_resolved_checkpoint_files(
                                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        pretrained_model_name_or_path=pretrained_model_name_or_path,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<15 lines>...
        transformers_explicit_filename=transformers_explicit_filename,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/modeling_utils.py", line 1216, in _get_resolved_checkpoint_files
    not has_file(pretrained_model_name_or_path, safe_weights_name, **has_file_kwargs)
        ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/utils/hub.py", line 679, in has_file
    response = get_session().head(
        hf_hub_url(path_or_repo, filename=filename, revision=revision, repo_type=repo_type),
    ...<3 lines>...
        timeout=10,
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/sessions.py", line 624, in head
    return self.request("HEAD", url, **kwargs)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/huggingface_hub/utils/_http.py", line 96, in send
    return super().send(request, *args, **kwargs)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/adapters.py", line 671, in send
    raise ProxyError(e, request=request)
requests.exceptions.ProxyError: (MaxRetryError("HTTPSConnectionPool(host='huggingface.co', port=443): Max retries exceeded with url: /facebook/nllb-200-distilled-600M/resolve/main/model.safetensors (Caused by ProxyError('Unable to connect to proxy', NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fe3ee7d79d0>: Failed to establish a new connection: [Errno 113] No route to host')))"), '(Request ID: 29bc8d12-6f87-4ac4-8994-c9ec7b10d987)')
✅ Finished evaluating zu-1k

----- Training zu 5k -----
usage: train.py [-h] [--model_name MODEL_NAME]
                [--data_base_path DATA_BASE_PATH] --lang LANG
                --data_size DATA_SIZE --src_lang_code SRC_LANG_CODE
                [--tgt_lang_code TGT_LANG_CODE] [--epochs EPOCHS]
                [--batch_size BATCH_SIZE]
                [--accumulation_steps ACCUMULATION_STEPS]
                [--learning_rate LEARNING_RATE] [--eval_steps EVAL_STEPS]
train.py: error: unrecognized arguments: --data_dir ./final_data2/zu/train_5k.tsv --validation_file ./final_data2/zu/validation.tsv
✅ Finished training zu-5k
----- Evaluating zu 5k -----
--- Evaluating zu 5k ---
⚠️  No best model found, loading latest checkpoint instead: ./zu-5k-finetune/checkpoint-120
Traceback (most recent call last):
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
OSError: [Errno 113] No route to host

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 773, in urlopen
    self._prepare_proxy(conn)
    ~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 1042, in _prepare_proxy
    conn.connect()
    ~~~~~~~~~~~~^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connection.py", line 753, in connect
    self.sock = sock = self._new_conn()
                       ~~~~~~~~~~~~~~^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7fe5a07d39d0>: Failed to establish a new connection: [Errno 113] No route to host

The above exception was the direct cause of the following exception:

urllib3.exceptions.ProxyError: ('Unable to connect to proxy', NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fe5a07d39d0>: Failed to establish a new connection: [Errno 113] No route to host'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/adapters.py", line 644, in send
    resp = conn.urlopen(
        method=request.method,
    ...<9 lines>...
        chunked=chunked,
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='huggingface.co', port=443): Max retries exceeded with url: /facebook/nllb-200-distilled-600M/resolve/main/model.safetensors (Caused by ProxyError('Unable to connect to proxy', NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fe5a07d39d0>: Failed to establish a new connection: [Errno 113] No route to host')))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/mwei/NMT_projects/evaluate.py", line 87, in <module>
    main(args)
    ~~~~^^^^^^
  File "/home/mwei/NMT_projects/evaluate.py", line 35, in main
    base_model = AutoModelForSeq2SeqLM.from_pretrained(
        "facebook/nllb-200-distilled-600M",
        quantization_config=quant_config,
        device_map="auto"
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/models/auto/auto_factory.py", line 604, in from_pretrained
    return model_class.from_pretrained(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        pretrained_model_name_or_path, *model_args, config=config, **hub_kwargs, **kwargs
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/modeling_utils.py", line 288, in _wrapper
    return func(*args, **kwargs)
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/modeling_utils.py", line 5030, in from_pretrained
    checkpoint_files, sharded_metadata = _get_resolved_checkpoint_files(
                                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        pretrained_model_name_or_path=pretrained_model_name_or_path,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<15 lines>...
        transformers_explicit_filename=transformers_explicit_filename,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/modeling_utils.py", line 1216, in _get_resolved_checkpoint_files
    not has_file(pretrained_model_name_or_path, safe_weights_name, **has_file_kwargs)
        ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/utils/hub.py", line 679, in has_file
    response = get_session().head(
        hf_hub_url(path_or_repo, filename=filename, revision=revision, repo_type=repo_type),
    ...<3 lines>...
        timeout=10,
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/sessions.py", line 624, in head
    return self.request("HEAD", url, **kwargs)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/huggingface_hub/utils/_http.py", line 96, in send
    return super().send(request, *args, **kwargs)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/adapters.py", line 671, in send
    raise ProxyError(e, request=request)
requests.exceptions.ProxyError: (MaxRetryError("HTTPSConnectionPool(host='huggingface.co', port=443): Max retries exceeded with url: /facebook/nllb-200-distilled-600M/resolve/main/model.safetensors (Caused by ProxyError('Unable to connect to proxy', NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fe5a07d39d0>: Failed to establish a new connection: [Errno 113] No route to host')))"), '(Request ID: 86e6908e-5d99-4598-90b0-9e5cdd8168b1)')
✅ Finished evaluating zu-5k

----- Training zu 25k -----
usage: train.py [-h] [--model_name MODEL_NAME]
                [--data_base_path DATA_BASE_PATH] --lang LANG
                --data_size DATA_SIZE --src_lang_code SRC_LANG_CODE
                [--tgt_lang_code TGT_LANG_CODE] [--epochs EPOCHS]
                [--batch_size BATCH_SIZE]
                [--accumulation_steps ACCUMULATION_STEPS]
                [--learning_rate LEARNING_RATE] [--eval_steps EVAL_STEPS]
train.py: error: unrecognized arguments: --data_dir ./final_data2/zu/train_25k.tsv --validation_file ./final_data2/zu/validation.tsv
✅ Finished training zu-25k
----- Evaluating zu 25k -----
--- Evaluating zu 25k ---
⚠️  No best model found, loading latest checkpoint instead: ./zu-25k-finetune/checkpoint-588
Traceback (most recent call last):
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
OSError: [Errno 113] No route to host

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 773, in urlopen
    self._prepare_proxy(conn)
    ~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 1042, in _prepare_proxy
    conn.connect()
    ~~~~~~~~~~~~^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connection.py", line 753, in connect
    self.sock = sock = self._new_conn()
                       ~~~~~~~~~~~~~~^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7fee999d39d0>: Failed to establish a new connection: [Errno 113] No route to host

The above exception was the direct cause of the following exception:

urllib3.exceptions.ProxyError: ('Unable to connect to proxy', NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fee999d39d0>: Failed to establish a new connection: [Errno 113] No route to host'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/adapters.py", line 644, in send
    resp = conn.urlopen(
        method=request.method,
    ...<9 lines>...
        chunked=chunked,
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='huggingface.co', port=443): Max retries exceeded with url: /facebook/nllb-200-distilled-600M/resolve/main/model.safetensors (Caused by ProxyError('Unable to connect to proxy', NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fee999d39d0>: Failed to establish a new connection: [Errno 113] No route to host')))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/mwei/NMT_projects/evaluate.py", line 87, in <module>
    main(args)
    ~~~~^^^^^^
  File "/home/mwei/NMT_projects/evaluate.py", line 35, in main
    base_model = AutoModelForSeq2SeqLM.from_pretrained(
        "facebook/nllb-200-distilled-600M",
        quantization_config=quant_config,
        device_map="auto"
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/models/auto/auto_factory.py", line 604, in from_pretrained
    return model_class.from_pretrained(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        pretrained_model_name_or_path, *model_args, config=config, **hub_kwargs, **kwargs
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/modeling_utils.py", line 288, in _wrapper
    return func(*args, **kwargs)
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/modeling_utils.py", line 5030, in from_pretrained
    checkpoint_files, sharded_metadata = _get_resolved_checkpoint_files(
                                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        pretrained_model_name_or_path=pretrained_model_name_or_path,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<15 lines>...
        transformers_explicit_filename=transformers_explicit_filename,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/modeling_utils.py", line 1216, in _get_resolved_checkpoint_files
    not has_file(pretrained_model_name_or_path, safe_weights_name, **has_file_kwargs)
        ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/utils/hub.py", line 679, in has_file
    response = get_session().head(
        hf_hub_url(path_or_repo, filename=filename, revision=revision, repo_type=repo_type),
    ...<3 lines>...
        timeout=10,
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/sessions.py", line 624, in head
    return self.request("HEAD", url, **kwargs)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/huggingface_hub/utils/_http.py", line 96, in send
    return super().send(request, *args, **kwargs)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/adapters.py", line 671, in send
    raise ProxyError(e, request=request)
requests.exceptions.ProxyError: (MaxRetryError("HTTPSConnectionPool(host='huggingface.co', port=443): Max retries exceeded with url: /facebook/nllb-200-distilled-600M/resolve/main/model.safetensors (Caused by ProxyError('Unable to connect to proxy', NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fee999d39d0>: Failed to establish a new connection: [Errno 113] No route to host')))"), '(Request ID: 0dadf40a-af34-41ed-8bec-51e200a66300)')
✅ Finished evaluating zu-25k

----- Training zu 100k -----
usage: train.py [-h] [--model_name MODEL_NAME]
                [--data_base_path DATA_BASE_PATH] --lang LANG
                --data_size DATA_SIZE --src_lang_code SRC_LANG_CODE
                [--tgt_lang_code TGT_LANG_CODE] [--epochs EPOCHS]
                [--batch_size BATCH_SIZE]
                [--accumulation_steps ACCUMULATION_STEPS]
                [--learning_rate LEARNING_RATE] [--eval_steps EVAL_STEPS]
train.py: error: unrecognized arguments: --data_dir ./final_data2/zu/train_100k.tsv --validation_file ./final_data2/zu/validation.tsv
✅ Finished training zu-100k
----- Evaluating zu 100k -----
--- Evaluating zu 100k ---
⚠️  No best model found, loading latest checkpoint instead: ./zu-100k-finetune/checkpoint-2346
Traceback (most recent call last):
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
OSError: [Errno 113] No route to host

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 773, in urlopen
    self._prepare_proxy(conn)
    ~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 1042, in _prepare_proxy
    conn.connect()
    ~~~~~~~~~~~~^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connection.py", line 753, in connect
    self.sock = sock = self._new_conn()
                       ~~~~~~~~~~~~~~^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7f1dd34c79d0>: Failed to establish a new connection: [Errno 113] No route to host

The above exception was the direct cause of the following exception:

urllib3.exceptions.ProxyError: ('Unable to connect to proxy', NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f1dd34c79d0>: Failed to establish a new connection: [Errno 113] No route to host'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/adapters.py", line 644, in send
    resp = conn.urlopen(
        method=request.method,
    ...<9 lines>...
        chunked=chunked,
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='huggingface.co', port=443): Max retries exceeded with url: /facebook/nllb-200-distilled-600M/resolve/main/model.safetensors (Caused by ProxyError('Unable to connect to proxy', NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f1dd34c79d0>: Failed to establish a new connection: [Errno 113] No route to host')))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/mwei/NMT_projects/evaluate.py", line 87, in <module>
    main(args)
    ~~~~^^^^^^
  File "/home/mwei/NMT_projects/evaluate.py", line 35, in main
    base_model = AutoModelForSeq2SeqLM.from_pretrained(
        "facebook/nllb-200-distilled-600M",
        quantization_config=quant_config,
        device_map="auto"
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/models/auto/auto_factory.py", line 604, in from_pretrained
    return model_class.from_pretrained(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        pretrained_model_name_or_path, *model_args, config=config, **hub_kwargs, **kwargs
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/modeling_utils.py", line 288, in _wrapper
    return func(*args, **kwargs)
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/modeling_utils.py", line 5030, in from_pretrained
    checkpoint_files, sharded_metadata = _get_resolved_checkpoint_files(
                                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        pretrained_model_name_or_path=pretrained_model_name_or_path,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<15 lines>...
        transformers_explicit_filename=transformers_explicit_filename,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/modeling_utils.py", line 1216, in _get_resolved_checkpoint_files
    not has_file(pretrained_model_name_or_path, safe_weights_name, **has_file_kwargs)
        ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/utils/hub.py", line 679, in has_file
    response = get_session().head(
        hf_hub_url(path_or_repo, filename=filename, revision=revision, repo_type=repo_type),
    ...<3 lines>...
        timeout=10,
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/sessions.py", line 624, in head
    return self.request("HEAD", url, **kwargs)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/huggingface_hub/utils/_http.py", line 96, in send
    return super().send(request, *args, **kwargs)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/adapters.py", line 671, in send
    raise ProxyError(e, request=request)
requests.exceptions.ProxyError: (MaxRetryError("HTTPSConnectionPool(host='huggingface.co', port=443): Max retries exceeded with url: /facebook/nllb-200-distilled-600M/resolve/main/model.safetensors (Caused by ProxyError('Unable to connect to proxy', NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f1dd34c79d0>: Failed to establish a new connection: [Errno 113] No route to host')))"), '(Request ID: 0371fc59-f302-44b9-af01-92e131d28c52)')
✅ Finished evaluating zu-100k

----- Training zu 500k -----
  File "/home/mwei/NMT_projects/train.py", line 48
    raise FileNotFoundError(f"
                            ^
SyntaxError: unterminated f-string literal (detected at line 48)
✅ Finished training zu-500k
----- Evaluating zu 500k -----
--- Evaluating zu 500k ---
Traceback (most recent call last):
  File "/home/mwei/NMT_projects/evaluate.py", line 87, in <module>
    main(args)
    ~~~~^^^^^^
  File "/home/mwei/NMT_projects/evaluate.py", line 32, in main
    model_path = find_best_or_latest_checkpoint(model_path)
  File "/home/mwei/NMT_projects/evaluate.py", line 15, in find_best_or_latest_checkpoint
    any(fname.startswith("pytorch_model") for fname in os.listdir(model_path_base)):
                                                       ~~~~~~~~~~^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: './zu-500k-finetune'
✅ Finished evaluating zu-500k

----- Training zu 1M -----
  File "/home/mwei/NMT_projects/train.py", line 48
    raise FileNotFoundError(f"
                            ^
SyntaxError: unterminated f-string literal (detected at line 48)
✅ Finished training zu-1M
----- Evaluating zu 1M -----
--- Evaluating zu 1M ---
Traceback (most recent call last):
  File "/home/mwei/NMT_projects/evaluate.py", line 87, in <module>
    main(args)
    ~~~~^^^^^^
  File "/home/mwei/NMT_projects/evaluate.py", line 32, in main
    model_path = find_best_or_latest_checkpoint(model_path)
  File "/home/mwei/NMT_projects/evaluate.py", line 15, in find_best_or_latest_checkpoint
    any(fname.startswith("pytorch_model") for fname in os.listdir(model_path_base)):
                                                       ~~~~~~~~~~^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: './zu-1M-finetune'
✅ Finished evaluating zu-1M

========== Language: ur (urd_Arab) ==========
----- Training ur 1k -----
  File "/home/mwei/NMT_projects/train.py", line 48
    raise FileNotFoundError(f"
                            ^
SyntaxError: unterminated f-string literal (detected at line 48)
✅ Finished training ur-1k
----- Evaluating ur 1k -----
--- Evaluating ur 1k ---
⚠️  No best model found, loading latest checkpoint instead: ./ur-1k-finetune/checkpoint-24
Traceback (most recent call last):
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
OSError: [Errno 113] No route to host

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 773, in urlopen
    self._prepare_proxy(conn)
    ~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 1042, in _prepare_proxy
    conn.connect()
    ~~~~~~~~~~~~^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connection.py", line 753, in connect
    self.sock = sock = self._new_conn()
                       ~~~~~~~~~~~~~~^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7f46674c79d0>: Failed to establish a new connection: [Errno 113] No route to host

The above exception was the direct cause of the following exception:

urllib3.exceptions.ProxyError: ('Unable to connect to proxy', NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f46674c79d0>: Failed to establish a new connection: [Errno 113] No route to host'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/adapters.py", line 644, in send
    resp = conn.urlopen(
        method=request.method,
    ...<9 lines>...
        chunked=chunked,
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='huggingface.co', port=443): Max retries exceeded with url: /facebook/nllb-200-distilled-600M/resolve/main/model.safetensors (Caused by ProxyError('Unable to connect to proxy', NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f46674c79d0>: Failed to establish a new connection: [Errno 113] No route to host')))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/mwei/NMT_projects/evaluate.py", line 87, in <module>
    main(args)
    ~~~~^^^^^^
  File "/home/mwei/NMT_projects/evaluate.py", line 35, in main
    base_model = AutoModelForSeq2SeqLM.from_pretrained(
        "facebook/nllb-200-distilled-600M",
        quantization_config=quant_config,
        device_map="auto"
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/models/auto/auto_factory.py", line 604, in from_pretrained
    return model_class.from_pretrained(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        pretrained_model_name_or_path, *model_args, config=config, **hub_kwargs, **kwargs
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/modeling_utils.py", line 288, in _wrapper
    return func(*args, **kwargs)
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/modeling_utils.py", line 5030, in from_pretrained
    checkpoint_files, sharded_metadata = _get_resolved_checkpoint_files(
                                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        pretrained_model_name_or_path=pretrained_model_name_or_path,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<15 lines>...
        transformers_explicit_filename=transformers_explicit_filename,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/modeling_utils.py", line 1216, in _get_resolved_checkpoint_files
    not has_file(pretrained_model_name_or_path, safe_weights_name, **has_file_kwargs)
        ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/utils/hub.py", line 679, in has_file
    response = get_session().head(
        hf_hub_url(path_or_repo, filename=filename, revision=revision, repo_type=repo_type),
    ...<3 lines>...
        timeout=10,
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/sessions.py", line 624, in head
    return self.request("HEAD", url, **kwargs)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/huggingface_hub/utils/_http.py", line 96, in send
    return super().send(request, *args, **kwargs)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/adapters.py", line 671, in send
    raise ProxyError(e, request=request)
requests.exceptions.ProxyError: (MaxRetryError("HTTPSConnectionPool(host='huggingface.co', port=443): Max retries exceeded with url: /facebook/nllb-200-distilled-600M/resolve/main/model.safetensors (Caused by ProxyError('Unable to connect to proxy', NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f46674c79d0>: Failed to establish a new connection: [Errno 113] No route to host')))"), '(Request ID: 177f3c27-acc0-4629-baab-98dc97f9aaba)')
✅ Finished evaluating ur-1k

----- Training ur 5k -----
  File "/home/mwei/NMT_projects/train.py", line 48
    raise FileNotFoundError(f"
                            ^
SyntaxError: unterminated f-string literal (detected at line 48)
✅ Finished training ur-5k
----- Evaluating ur 5k -----
--- Evaluating ur 5k ---
⚠️  No best model found, loading latest checkpoint instead: ./ur-5k-finetune/checkpoint-120
Traceback (most recent call last):
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
OSError: [Errno 113] No route to host

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 773, in urlopen
    self._prepare_proxy(conn)
    ~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 1042, in _prepare_proxy
    conn.connect()
    ~~~~~~~~~~~~^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connection.py", line 753, in connect
    self.sock = sock = self._new_conn()
                       ~~~~~~~~~~~~~~^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7fd85df0b9d0>: Failed to establish a new connection: [Errno 113] No route to host

The above exception was the direct cause of the following exception:

urllib3.exceptions.ProxyError: ('Unable to connect to proxy', NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fd85df0b9d0>: Failed to establish a new connection: [Errno 113] No route to host'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/adapters.py", line 644, in send
    resp = conn.urlopen(
        method=request.method,
    ...<9 lines>...
        chunked=chunked,
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='huggingface.co', port=443): Max retries exceeded with url: /facebook/nllb-200-distilled-600M/resolve/main/model.safetensors (Caused by ProxyError('Unable to connect to proxy', NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fd85df0b9d0>: Failed to establish a new connection: [Errno 113] No route to host')))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/mwei/NMT_projects/evaluate.py", line 87, in <module>
    main(args)
    ~~~~^^^^^^
  File "/home/mwei/NMT_projects/evaluate.py", line 35, in main
    base_model = AutoModelForSeq2SeqLM.from_pretrained(
        "facebook/nllb-200-distilled-600M",
        quantization_config=quant_config,
        device_map="auto"
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/models/auto/auto_factory.py", line 604, in from_pretrained
    return model_class.from_pretrained(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        pretrained_model_name_or_path, *model_args, config=config, **hub_kwargs, **kwargs
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/modeling_utils.py", line 288, in _wrapper
    return func(*args, **kwargs)
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/modeling_utils.py", line 5030, in from_pretrained
    checkpoint_files, sharded_metadata = _get_resolved_checkpoint_files(
                                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        pretrained_model_name_or_path=pretrained_model_name_or_path,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<15 lines>...
        transformers_explicit_filename=transformers_explicit_filename,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/modeling_utils.py", line 1216, in _get_resolved_checkpoint_files
    not has_file(pretrained_model_name_or_path, safe_weights_name, **has_file_kwargs)
        ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/utils/hub.py", line 679, in has_file
    response = get_session().head(
        hf_hub_url(path_or_repo, filename=filename, revision=revision, repo_type=repo_type),
    ...<3 lines>...
        timeout=10,
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/sessions.py", line 624, in head
    return self.request("HEAD", url, **kwargs)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/huggingface_hub/utils/_http.py", line 96, in send
    return super().send(request, *args, **kwargs)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/adapters.py", line 671, in send
    raise ProxyError(e, request=request)
requests.exceptions.ProxyError: (MaxRetryError("HTTPSConnectionPool(host='huggingface.co', port=443): Max retries exceeded with url: /facebook/nllb-200-distilled-600M/resolve/main/model.safetensors (Caused by ProxyError('Unable to connect to proxy', NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fd85df0b9d0>: Failed to establish a new connection: [Errno 113] No route to host')))"), '(Request ID: 70cf2645-6a98-4864-9673-c7db19fcface)')
✅ Finished evaluating ur-5k

----- Training ur 25k -----
  File "/home/mwei/NMT_projects/train.py", line 48
    raise FileNotFoundError(f"
                            ^
SyntaxError: unterminated f-string literal (detected at line 48)
✅ Finished training ur-25k
----- Evaluating ur 25k -----
--- Evaluating ur 25k ---
⚠️  No best model found, loading latest checkpoint instead: ./ur-25k-finetune/checkpoint-588
Traceback (most recent call last):
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
OSError: [Errno 113] No route to host

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 773, in urlopen
    self._prepare_proxy(conn)
    ~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 1042, in _prepare_proxy
    conn.connect()
    ~~~~~~~~~~~~^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connection.py", line 753, in connect
    self.sock = sock = self._new_conn()
                       ~~~~~~~~~~~~~~^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7fc5c3bc79d0>: Failed to establish a new connection: [Errno 113] No route to host

The above exception was the direct cause of the following exception:

urllib3.exceptions.ProxyError: ('Unable to connect to proxy', NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fc5c3bc79d0>: Failed to establish a new connection: [Errno 113] No route to host'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/adapters.py", line 644, in send
    resp = conn.urlopen(
        method=request.method,
    ...<9 lines>...
        chunked=chunked,
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='huggingface.co', port=443): Max retries exceeded with url: /facebook/nllb-200-distilled-600M/resolve/main/model.safetensors (Caused by ProxyError('Unable to connect to proxy', NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fc5c3bc79d0>: Failed to establish a new connection: [Errno 113] No route to host')))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/mwei/NMT_projects/evaluate.py", line 87, in <module>
    main(args)
    ~~~~^^^^^^
  File "/home/mwei/NMT_projects/evaluate.py", line 35, in main
    base_model = AutoModelForSeq2SeqLM.from_pretrained(
        "facebook/nllb-200-distilled-600M",
        quantization_config=quant_config,
        device_map="auto"
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/models/auto/auto_factory.py", line 604, in from_pretrained
    return model_class.from_pretrained(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        pretrained_model_name_or_path, *model_args, config=config, **hub_kwargs, **kwargs
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/modeling_utils.py", line 288, in _wrapper
    return func(*args, **kwargs)
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/modeling_utils.py", line 5030, in from_pretrained
    checkpoint_files, sharded_metadata = _get_resolved_checkpoint_files(
                                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        pretrained_model_name_or_path=pretrained_model_name_or_path,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<15 lines>...
        transformers_explicit_filename=transformers_explicit_filename,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/modeling_utils.py", line 1216, in _get_resolved_checkpoint_files
    not has_file(pretrained_model_name_or_path, safe_weights_name, **has_file_kwargs)
        ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/utils/hub.py", line 679, in has_file
    response = get_session().head(
        hf_hub_url(path_or_repo, filename=filename, revision=revision, repo_type=repo_type),
    ...<3 lines>...
        timeout=10,
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/sessions.py", line 624, in head
    return self.request("HEAD", url, **kwargs)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/huggingface_hub/utils/_http.py", line 96, in send
    return super().send(request, *args, **kwargs)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/adapters.py", line 671, in send
    raise ProxyError(e, request=request)
requests.exceptions.ProxyError: (MaxRetryError("HTTPSConnectionPool(host='huggingface.co', port=443): Max retries exceeded with url: /facebook/nllb-200-distilled-600M/resolve/main/model.safetensors (Caused by ProxyError('Unable to connect to proxy', NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fc5c3bc79d0>: Failed to establish a new connection: [Errno 113] No route to host')))"), '(Request ID: 6c2fd08a-647a-4c11-9ec0-83c6ea456270)')
✅ Finished evaluating ur-25k

----- Training ur 100k -----
  File "/home/mwei/NMT_projects/train.py", line 48
    raise FileNotFoundError(f"
                            ^
SyntaxError: unterminated f-string literal (detected at line 48)
✅ Finished training ur-100k
----- Evaluating ur 100k -----
--- Evaluating ur 100k ---
⚠️  No best model found, loading latest checkpoint instead: ./ur-100k-finetune/checkpoint-2346
Traceback (most recent call last):
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
OSError: [Errno 113] No route to host

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 773, in urlopen
    self._prepare_proxy(conn)
    ~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 1042, in _prepare_proxy
    conn.connect()
    ~~~~~~~~~~~~^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connection.py", line 753, in connect
    self.sock = sock = self._new_conn()
                       ~~~~~~~~~~~~~~^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x7f8111adf9d0>: Failed to establish a new connection: [Errno 113] No route to host

The above exception was the direct cause of the following exception:

urllib3.exceptions.ProxyError: ('Unable to connect to proxy', NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f8111adf9d0>: Failed to establish a new connection: [Errno 113] No route to host'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/adapters.py", line 644, in send
    resp = conn.urlopen(
        method=request.method,
    ...<9 lines>...
        chunked=chunked,
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='huggingface.co', port=443): Max retries exceeded with url: /facebook/nllb-200-distilled-600M/resolve/main/model.safetensors (Caused by ProxyError('Unable to connect to proxy', NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f8111adf9d0>: Failed to establish a new connection: [Errno 113] No route to host')))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/mwei/NMT_projects/evaluate.py", line 87, in <module>
    main(args)
    ~~~~^^^^^^
  File "/home/mwei/NMT_projects/evaluate.py", line 35, in main
    base_model = AutoModelForSeq2SeqLM.from_pretrained(
        "facebook/nllb-200-distilled-600M",
        quantization_config=quant_config,
        device_map="auto"
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/models/auto/auto_factory.py", line 604, in from_pretrained
    return model_class.from_pretrained(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        pretrained_model_name_or_path, *model_args, config=config, **hub_kwargs, **kwargs
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/modeling_utils.py", line 288, in _wrapper
    return func(*args, **kwargs)
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/modeling_utils.py", line 5030, in from_pretrained
    checkpoint_files, sharded_metadata = _get_resolved_checkpoint_files(
                                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        pretrained_model_name_or_path=pretrained_model_name_or_path,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<15 lines>...
        transformers_explicit_filename=transformers_explicit_filename,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/modeling_utils.py", line 1216, in _get_resolved_checkpoint_files
    not has_file(pretrained_model_name_or_path, safe_weights_name, **has_file_kwargs)
        ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/transformers/utils/hub.py", line 679, in has_file
    response = get_session().head(
        hf_hub_url(path_or_repo, filename=filename, revision=revision, repo_type=repo_type),
    ...<3 lines>...
        timeout=10,
    )
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/sessions.py", line 624, in head
    return self.request("HEAD", url, **kwargs)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/huggingface_hub/utils/_http.py", line 96, in send
    return super().send(request, *args, **kwargs)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mwei/NMT_projects/MAenv/lib/python3.13/site-packages/requests/adapters.py", line 671, in send
    raise ProxyError(e, request=request)
requests.exceptions.ProxyError: (MaxRetryError("HTTPSConnectionPool(host='huggingface.co', port=443): Max retries exceeded with url: /facebook/nllb-200-distilled-600M/resolve/main/model.safetensors (Caused by ProxyError('Unable to connect to proxy', NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f8111adf9d0>: Failed to establish a new connection: [Errno 113] No route to host')))"), '(Request ID: c2006605-9331-45aa-9bd7-a7d020f6540a)')
✅ Finished evaluating ur-100k

----- Training ur 500k -----
  File "/home/mwei/NMT_projects/train.py", line 48
    raise FileNotFoundError(f"
                            ^
SyntaxError: unterminated f-string literal (detected at line 48)
✅ Finished training ur-500k
----- Evaluating ur 500k -----
--- Evaluating ur 500k ---
Traceback (most recent call last):
  File "/home/mwei/NMT_projects/evaluate.py", line 87, in <module>
    main(args)
    ~~~~^^^^^^
  File "/home/mwei/NMT_projects/evaluate.py", line 32, in main
    model_path = find_best_or_latest_checkpoint(model_path)
  File "/home/mwei/NMT_projects/evaluate.py", line 15, in find_best_or_latest_checkpoint
    any(fname.startswith("pytorch_model") for fname in os.listdir(model_path_base)):
                                                       ~~~~~~~~~~^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: './ur-500k-finetune'
✅ Finished evaluating ur-500k

----- Training ur 1M -----
usage: train.py [-h] [--model_name MODEL_NAME]
                [--data_base_path DATA_BASE_PATH] --lang LANG
                --data_size DATA_SIZE --src_lang_code SRC_LANG_CODE
                [--tgt_lang_code TGT_LANG_CODE] [--epochs EPOCHS]
                [--batch_size BATCH_SIZE]
                [--accumulation_steps ACCUMULATION_STEPS]
                [--learning_rate LEARNING_RATE] [--eval_steps EVAL_STEPS]
train.py: error: unrecognized arguments: --data_dir ./final_data2/ur/train_1M.tsv --validation_file ./final_data2/ur/validation.tsv
✅ Finished training ur-1M
----- Evaluating ur 1M -----
--- Evaluating ur 1M ---
Traceback (most recent call last):
  File "/home/mwei/NMT_projects/evaluate.py", line 87, in <module>
    main(args)
    ~~~~^^^^^^
  File "/home/mwei/NMT_projects/evaluate.py", line 32, in main
    model_path = find_best_or_latest_checkpoint(model_path)
  File "/home/mwei/NMT_projects/evaluate.py", line 15, in find_best_or_latest_checkpoint
    any(fname.startswith("pytorch_model") for fname in os.listdir(model_path_base)):
                                                       ~~~~~~~~~~^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: './ur-1M-finetune'
✅ Finished evaluating ur-1M

========== All Experiments Completed ✅ ==========
